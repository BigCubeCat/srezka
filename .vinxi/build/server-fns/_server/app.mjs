import{ssr as b,ssrHydrationKey as p,escape as g,ssrAttribute as y,createComponent as h}from"solid-js/web";import{createSignal as C}from"solid-js";import"jspdf";var D=["<div",' class="Row"><div class="Label">','</div><input class="ColorPicker" type="color"',"></div>"];const U=t=>b(D,p(),g(t.label),y("value",g(t.value,!0),!1));var F=["<div",' class="Column"><div class="Label">','</div><input class="SpinBox" type="number" min="1"',"></div>"];const I=t=>b(F,p(),g(t.label),y("value",g(t.value,!0),!1));var S=["<div",' class="Config"><div class="Geometry"><!--$-->',"<!--/--><!--$-->","<!--/--></div><!--$-->","<!--/--></div>"];const _=t=>b(S,p(),g(h(I,{label:"Строк",get value(){return t.rows},get callback(){return t.setRows}})),g(h(I,{label:"Столбцов",get value(){return t.cols},get callback(){return t.setCols}})),g(h(U,{label:"Цвет",get onChange(){return t.setColor},get value(){return t.color}})));var A=["<div",' class="file-input-container"><input type="file" accept="image/png, image/jpeg" style="','"><button type="button" class="file-input-button">',"</button></div>"];const G=t=>b(A,p(),"display:none",g(t.label)||"Выберите файл"),P=t=>h(G,{label:"Файл с картой",handleFileChange:n=>{const a=n.target;if(a.files&&a.files[0]){const v=a.files[0],c=new FileReader;c.onload=d=>{t.imageCallback(d.target?.result)},c.readAsDataURL(v)}}}),L=(t,i,n,a,v)=>{const c=[];for(let d=0;d<t;d++)for(let l=0;l<i;l++){const u=document.createElement("canvas");u.width=n,u.height=a;const f=u.getContext("2d");f&&(f.drawImage(v,l*n,d*a,n,a,0,0,n,a),c.push(u.toDataURL("image/png")))}return c},T=15,j=12,M=()=>{const[t,i]=C(null),[n,a]=C(null),[v,c]=C([]);return{imageSrc:t,setImageSrc:i,fullImageDataUrl:n,cellDataUrls:v,generateGrid:(l,u,f)=>{if(!t())return;const o=new Image;o.onload=()=>{const r=document.createElement("canvas"),e=r.getContext("2d");if(!e)return;o.width>o.height?(r.width=o.height,r.height=o.width,e.save(),e.translate(r.width,0),e.rotate(Math.PI/2),e.drawImage(o,0,0),e.restore()):(r.width=o.width,r.height=o.height,e.drawImage(o,0,0));const w=r.width/u,$=r.height/l;c(L(l,u,w,$,r)),e.strokeStyle=f,e.lineWidth=2;for(let s=0;s<=u;s++){const m=s*w;e.beginPath(),e.moveTo(m,0),e.lineTo(m,r.height),e.stroke()}for(let s=0;s<=l;s++){const m=s*$;e.beginPath(),e.moveTo(0,m),e.lineTo(r.width,m),e.stroke()}e.font="20px Arial",e.fillStyle=f,e.textAlign="center",e.textBaseline="middle";for(let s=0;s<l;s++)for(let m=0;m<u;m++){const x=`${String.fromCharCode(65+s)}${m+1}`,R=m*w+T,k=s*$+j;e.fillText(x,R,k)}a(r.toDataURL("image/png"))},o.src=t()}}},B=(t=3,i=3)=>{const[n,a]=C(t),[v,c]=C(i),[d,l]=C("#000000");return{rows:n,setRows:a,cols:v,setCols:c,color:d,setColor:l}};var E=["<div",' class="MainComponent"><!--$-->',"<!--/--><!--$-->",'<!--/--><button type="button" class="download-button">Скачать</button></div>'];const X=()=>{const{rows:t,cols:i,color:n,setRows:a,setCols:v,setColor:c}=B(),{setImageSrc:d,generateGrid:l,fullImageDataUrl:u}=M(),f=e=>{d(e),l(t(),i(),n())},o=e=>w=>{e(w),l(t(),i(),n())},r=e=>{c(e),l(t(),i(),n())};return b(E,p(),g(h(_,{get rows(){return t()},get cols(){return i()},get color(){return n()},get setRows(){return o(a)},get setCols(){return o(v)},setColor:r})),g(h(P,{imageCallback:f,get dataUrl(){return u()||""}})))};var Y=["<div",' class="app">',"</div>"];const J=()=>b(Y,p(),g(h(X,{})));export{J as default};
